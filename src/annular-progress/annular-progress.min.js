/*! annular-progress 2014-11-10 */
!function(a){function b(a){this.opts={targetDom:document.body,lineWidth:20,width:0,fcolor:"#5ab1ef",unfcolor:"#ccc",max:100,value:0,textColor:null,fontSize:20,fontStyle:"normal",fontFamily:"Arial",fontWeight:"Bold",textFormatter:null},d.extend(this.opts,a)}function c(a,b){var c=b,d=c.width/2;a.font=c.fontStyle+" "+c.fontWeight+" "+c.fontSize+"px "+c.fontFamily,a.textAlign="center",a.textBaseline="middle",a.fillStyle=c.textColor||c.fcolor;var e="";e="function"==typeof c.textFormatter?c.textFormatter(c.max,c.value):Math.round(c.value/c.max*100)+"%",a.fillText(e,d,d)}b.prototype={render:function(){var b,e,f=this.opts,g=f.width,h=g/2;if(this.getCanvas())b=this.getCanvas();else{b=document.createElement("canvas"),b.id=this.id=d.getGUID(),b.width=b.height=g;var i="string"==typeof f.targetDom?document.getElementById(f.targetDom):f.targetDom;i.innerHTML="",i.appendChild(b),a.G_vmlCanvasManager&&a.G_vmlCanvasManager.initElement(b)}if(b.getContext){e=b.getContext("2d"),e.clearRect(0,0,g,g),e.lineWidth=f.lineWidth,e.strokeStyle=f.fcolor;var j=-(Math.PI/2),k=f.value/f.max,l=g/2-f.lineWidth,m=g/2;if(1===k)e.beginPath(),e.arc(h,h,m,0,2*Math.PI,!0),e.arc(h,h,l,0,2*Math.PI,!0),e.fill(),e.closePath();else{var n=j-2*Math.PI*k;e.beginPath(),e.fillStyle=f.fcolor,e.arc(h,h,m,j,n,!0),e.lineTo(h,h),e.fill(),e.beginPath(),e.fillStyle=f.unfcolor,e.arc(h,h,m,n,j,!0),e.lineTo(h,h),e.fill(),e.beginPath(),e.arc(h,h,l,0,2*Math.PI,!0),e.fillStyle="#fff",e.fill(),e.closePath(),e.fillText||d.extend(e,{measureText:function(a){var b=document.createElement("span");b.style.font=this.font,b.innerHTML=a;var c=document.getElementsByTagName("body")[0];c.appendChild(b);var d=b.offsetWidth;return c.removeChild(b),{width:d}},fillText:function(a,b,c){var d=[];if(!this.textHeight){var e=this.font.split(" ")[2];this.textHeight=+e.replace("px","")+2}var f=this.measureText(a).width;d.push('<g_vml_:shape style="font:'+this.font+";"," color:"+this.fillStyle+";"," position:absolute;"," left:"+(b-f/2)+"px;"," top:"+(c-this.textHeight/2)+"px;"," width:"+f+"px;"," height:"+this.textHeight+'px;"',' ><g_vml_:textbox inset="0,0,0,0">'+a," </g_vml_:textbox>","</g_vml_:shape>"),this.element_.insertAdjacentHTML("BeforeEnd",d.join(""))}}),c(e,f)}}},setOptions:function(a){d.extend(this.opts,a),this.render()},getCanvas:function(){return document.getElementById(this.id)}};var d={},e=6557701;d.extend=function(a,b){for(var c=1,d=arguments.length;d>c;c++)if(b=arguments[c])for(var e in b)b.hasOwnProperty(e)&&(a[e]=b[e]);return a},d.getGUID=function(){return"an-"+e++};var f=function(a){return new b(a)};"function"==typeof define?define("annular",[],function(){return f}):a.annular=f}(window);